<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>《汇编语言》王爽_第5章笔记 | LucyConan</title><meta name="description" content="[bx]和内存单元的描述要完整地描述一个内存单元，需要两种信息：  内存单元的地址  内存单元的长度   [bx] 也表示一个内存单元，它的偏移地址在 bx 中。 mov ax,[bx] ：将一个内存单元的内容送入ax，这个内存单元的长度为2字节，偏移地址在bx中，段地址在ds中。 mov al,[bx] ：将一个内存单元的内容送入al，这个内存单元的长度为1字节，偏移地址在bx中，段地址在ds中"><meta name="keywords" content="汇编"><meta name="author" content="LucyConan"><meta name="copyright" content="LucyConan"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://lucyconan.github.io/2020/08/03/%E3%80%8A%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E3%80%8B%E7%8E%8B%E7%88%BD-%E7%AC%AC5%E7%AB%A0%E7%AC%94%E8%AE%B0/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="《汇编语言》王爽_第5章笔记"><meta property="og:url" content="http://lucyconan.github.io/2020/08/03/%E3%80%8A%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E3%80%8B%E7%8E%8B%E7%88%BD-%E7%AC%AC5%E7%AB%A0%E7%AC%94%E8%AE%B0/"><meta property="og:site_name" content="LucyConan"><meta property="og:description" content="[bx]和内存单元的描述要完整地描述一个内存单元，需要两种信息：  内存单元的地址  内存单元的长度   [bx] 也表示一个内存单元，它的偏移地址在 bx 中。 mov ax,[bx] ：将一个内存单元的内容送入ax，这个内存单元的长度为2字节，偏移地址在bx中，段地址在ds中。 mov al,[bx] ：将一个内存单元的内容送入al，这个内存单元的长度为1字节，偏移地址在bx中，段地址在ds中"><meta property="og:image" content="http://lucyconan.github.io/img/huibian.png"><meta property="article:published_time" content="2020-08-03T12:41:17.000Z"><meta property="article:modified_time" content="2020-08-03T12:46:29.468Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="next" title="《汇编语言》王爽_第4章笔记" href="http://lucyconan.github.io/2020/08/02/%E3%80%8A%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E3%80%8B%E7%8E%8B%E7%88%BD_%E7%AC%AC4%E7%AB%A0%E7%AC%94%E8%AE%B0/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">4</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">1</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">2</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#bx-和内存单元的描述"><span class="toc-number">1.</span> <span class="toc-text">[bx]和内存单元的描述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#我们定义的描述性符号：“-”"><span class="toc-number">2.</span> <span class="toc-text">我们定义的描述性符号：“()”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#约定符号idata表示常量"><span class="toc-number">3.</span> <span class="toc-text">约定符号idata表示常量</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BX"><span class="toc-number"></span> <span class="toc-text">[BX]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Loop指令"><span class="toc-number"></span> <span class="toc-text">Loop指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#在Debug中跟踪用loop指令实现的循环程序"><span class="toc-number"></span> <span class="toc-text">在Debug中跟踪用loop指令实现的循环程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Debug和汇编编译器masm对指令的不同处理"><span class="toc-number"></span> <span class="toc-text">Debug和汇编编译器masm对指令的不同处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#loop和-bx-的联合应用"><span class="toc-number"></span> <span class="toc-text">loop和[bx]的联合应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#段前缀"><span class="toc-number"></span> <span class="toc-text">段前缀</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一段安全的空间"><span class="toc-number"></span> <span class="toc-text">一段安全的空间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#段前缀的使用"><span class="toc-number"></span> <span class="toc-text">段前缀的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实验4-bx-和loop的使用"><span class="toc-number"></span> <span class="toc-text">实验4 [bx]和loop的使用</span></a></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/huibian.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">LucyConan</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">《汇编语言》王爽_第5章笔记</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2020-08-03 20:41:17"><i class="far fa-calendar-alt fa-fw"></i> Created 2020-08-03</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2020-08-03 20:46:29"><i class="fas fa-history fa-fw"></i> Updated 2020-08-03</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/%E6%B1%87%E7%BC%96/">汇编</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h4 id="bx-和内存单元的描述"><a href="#bx-和内存单元的描述" class="headerlink" title="[bx]和内存单元的描述"></a>[bx]和内存单元的描述</h4><p>要完整地描述一个内存单元，需要两种信息：</p>
<ul>
<li><p>内存单元的地址</p>
</li>
<li><p>内存单元的长度</p>
</li>
</ul>
<p>[bx] 也表示一个内存单元，它的偏移地址在 bx 中。</p>
<p><code>mov ax,[bx]</code> ：将一个内存单元的内容送入ax，这个内存单元的长度为2字节，偏移地址在bx中，段地址在ds中。</p>
<p><code>mov al,[bx]</code> ：将一个内存单元的内容送入al，这个内存单元的长度为1字节，偏移地址在bx中，段地址在ds中。</p>
<h4 id="我们定义的描述性符号：“-”"><a href="#我们定义的描述性符号：“-”" class="headerlink" title="我们定义的描述性符号：“()”"></a>我们定义的描述性符号：“()”</h4><p>我们用 <code>()</code> 来表示一个寄存器或一个内存单元中的内容。（<code>()</code>中的内存单元的地址为物理地址）</p>
<p>假设 ds 中的内容为 ADR1，bx 中的内容为 ADR2，则 <code>((ds)*16+(bx))</code>  表示：内存 ADR1:ADR2 单元的内容。</p>
<p><code>()</code> 中的元素可以有3中类型：</p>
<ul>
<li>寄存器名</li>
<li>段寄存器名</li>
<li>内存单元的物理地址（一个20位数据）</li>
</ul>
<p><code>(X)</code> 所表示的数据有两种类型：字节、字。</p>
<p>(al)、(bl)、(cl)等得到的数据为字节型；(ax)、(bx)、(cx)等得到的数据为字型。</p>
<h4 id="约定符号idata表示常量"><a href="#约定符号idata表示常量" class="headerlink" title="约定符号idata表示常量"></a>约定符号idata表示常量</h4><p>以后我们用 <code>idata</code> 表示常量。</p>
<p>比如：<code>mov ax,[idata]</code> 就代表 <code>mov ax,[1]</code>，<code>mov ax,[2]</code>，<code>mov ax,[3]</code> 等。</p>
<h2 id="BX"><a href="#BX" class="headerlink" title="[BX]"></a>[BX]</h2><p>程序和内存中的情况如图所示，写出程序执行后，21000H~21007H单元中的内容。</p>
<p>P.S. <code>inc bc</code> 的含义是bx中的内容加1。</p>
<p>执行前：</p>
<img src= "/img/loading.gif" data-src="D:/WangAn/Reverse/汇编语言王爽课程工具包（2019年11月28日）/Note/img/程序和内存情况.png" alt="image-20200802204525056" style="zoom:70%;" />

<p>执行后：</p>
<img src= "/img/loading.gif" data-src="D:/WangAn/Reverse/汇编语言王爽课程工具包（2019年11月28日）/Note/img/内存中的情况.png" alt="image-20200802204637646" style="zoom:70%;" />

<p>这里用到的都是前几章的知识，就不写分析了。</p>
<h2 id="Loop指令"><a href="#Loop指令" class="headerlink" title="Loop指令"></a>Loop指令</h2><p>loop指令的格式是：<code>loop 标号</code></p>
<p>CPU执行loop指令的时候，要进行两步操作：</p>
<ul>
<li>(cx) = (cx) - 1</li>
<li>判断 cx 中的值，不为零则转至标号处执行程序，如果为零则向下执行</li>
</ul>
<p>通常我们用 loop 指令来实现循环功能，cx 中存放循环次数。</p>
<p>任务1：编程计算2^2，结果存在ax中。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">	mov ax,2</span><br><span class="line">	add ax,ax</span><br><span class="line">	</span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>任务2：编程计算2^3。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">	mov ax,2</span><br><span class="line">	add ax,ax</span><br><span class="line">	add ax,ax</span><br><span class="line">	</span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>任务3：编程计算2^12</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">	mov ax,2</span><br><span class="line">	;做11次 add ax,ax</span><br><span class="line"></span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>按照我们的算法，计算 2^12 需要11条重复的指令 <code>add ax,ax</code> ，我们显然不想这样写程序，这里，可用 loop 来简化我们的程序。</p>
<p>程序5.1</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">	mov ax,2</span><br><span class="line">	mov cx,11</span><br><span class="line">s:	add ax,ax</span><br><span class="line">	loop s</span><br><span class="line">	</span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p><strong>程序分析</strong></p>
<p>标号：在汇编语言中，标号代表一个地址，程序5.1中有一个标号 <code>s</code> 。它实际标识了一个地址，这个地址处有一条指令：<code>add ax,ax</code> 。</p>
<p><code>loop s</code> ：执行 <code>loop s</code> 时，首先要将(cx)减1，然后若(cx)不为0，则向前转至 s 处执行 <code>add ax,ax</code> 。所以，可以利用 cx 来控制 <code>add ax,ax</code> 的执行次数。</p>
<p>用 cx 和 loop 指令相配合实现循环功能的3个要点：</p>
<ul>
<li><p>在 cx 中存放循环次数；</p>
</li>
<li><p>loop 指令中的标号所标识地址要在前面；</p>
</li>
<li><p>要循环执行的程序段，要写在标号和 loop 指令的中间。</p>
</li>
</ul>
<p>用 cx 和 loop 指令相配合实现循环功能的程序框架如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">	mov cx,循环次数</span><br><span class="line">s:</span><br><span class="line">	循环执行的程序段</span><br><span class="line">	loop s</span><br></pre></td></tr></table></figure>

<p>练习：用加法计算 123*236，结果存在 ax 中。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">	mov ax,0</span><br><span class="line">	mov cx,236</span><br><span class="line">s:	add ax,123</span><br><span class="line">	loop s</span><br><span class="line">	</span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>该程序执行了236次+123，其实执行123次+236会比上面的程序更好。</p>
<h2 id="在Debug中跟踪用loop指令实现的循环程序"><a href="#在Debug中跟踪用loop指令实现的循环程序" class="headerlink" title="在Debug中跟踪用loop指令实现的循环程序"></a>在Debug中跟踪用loop指令实现的循环程序</h2><p>问题：计算 ffff:0006 单元中的数乘以3，结果存储在 dx 中。</p>
<p>程序</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">	mov ax,0ffffh	;这里注意：汇编中数据不能以字母开头，编译器会报错，前面一定要加0</span><br><span class="line">	mov ds,ax</span><br><span class="line">	mov bx,6		;以上，设置ds:bx指向ffff:6</span><br><span class="line">	</span><br><span class="line">	mov al,[bx]</span><br><span class="line">	mov ah,0		;以上，设置(al) &#x3D; ( (ds)*16 + (bx) )，(ah) &#x3D; 0</span><br><span class="line">	</span><br><span class="line">	mov dx,0		;累加寄存器清0</span><br><span class="line">	</span><br><span class="line">	mov cx,3		;循环3次</span><br><span class="line">  s:add dx,ax</span><br><span class="line">	loop s			;以上累加计算(ax)*3</span><br><span class="line">	</span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h			;程序返回</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>Debug跟踪（部分）</p>
<p><img src= "/img/loading.gif" data-src="%E5%88%9D%E5%A7%8B%E5%8C%96%E7%B4%AF%E5%8A%A0%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8C%E5%BE%AA%E7%8E%AF%E8%AE%A1%E6%95%B0%E5%AF%84%E5%AD%98%E5%99%A8.png" alt="初始化累加寄存器和循环计数寄存器"></p>
<p>这两条指令执行后，(dx) = 0，完成对累加寄存器的初始化；(cx) = 3，完成了对循环计数寄存器的初始化。下面开始循环程序段的执行。</p>
<p><img src= "/img/loading.gif" data-src="%E7%AC%AC1%E6%AC%A1%E5%BE%AA%E7%8E%AF.png" alt="第1次循环"></p>
<p>这是第一次循环。</p>
<p>CPU执行 <code>loop 0012</code> ，第一步先将 (cx) 减1，(cx)=2，第二步因 (cx) 不等于0，将 IP 设为 0012h。</p>
<p>接着，重复执行 <code>add dx,ax</code> 和 <code>loop 0012</code> ，直到 (cx) = 0为止。</p>
<p><img src= "/img/loading.gif" data-src="%E5%BE%AA%E7%8E%AF.png" alt="循环"></p>
<p>在完成最后一次 <code>add dx,ax</code> 后，(dx) = 93h，此时 dx 中为累加计算 (ax)*3 的最后结果。</p>
<p>假设标号 s 前的指令，已经确定在逻辑上完全正确，我们不想再一步步跟踪，只想跟踪循环的过程，可以使用Debug命令 <code>g</code> 一次执行完标号 <code>s</code> 前的指令。</p>
<p>循环程序段从 CS:0012 开始， <code>g CS:0012</code> 表示执行程序到当前代码段（段地址在CS中）的0012h处。</p>
<p><img src= "/img/loading.gif" data-src="g.png" alt="g"></p>
<p>Debug执行 <code>g 0012</code> 后，CS:0012 前的程序段被执行，从各个相关的寄存器中的值，我们可以看出执行的结果。</p>
<p>那么，如果我们希望循环一次执行完，可以使用 <code>p</code> 命令来执行，Debug就会自动重复执行循环中的指令，直到 (cx)=0 为止。</p>
<p><img src= "/img/loading.gif" data-src="p.png" alt="p"></p>
<p>在遇到 <code>loop</code> 时，用 <code>p</code> 命令执行，Debug自动重复执行 <code>loop 0012</code> 和 <code>add dx,ax</code> 两条指令，直到 (cx)=0。</p>
<p>当然也可以使用 <code>g 0016</code> 直接执行到 CS:0016 处来达到目的。</p>
<h2 id="Debug和汇编编译器masm对指令的不同处理"><a href="#Debug和汇编编译器masm对指令的不同处理" class="headerlink" title="Debug和汇编编译器masm对指令的不同处理"></a>Debug和汇编编译器masm对指令的不同处理</h2><p>Debug 和 masm对 <code>mov al,[0]</code> 等指令有不同的解释</p>
<p>Debug对 <code>mov al,[0]</code> 等指令的解释</p>
<img src= "/img/loading.gif" data-src="Debug的解释.png" alt="Debug的解释" style="zoom:60%;" />

<p>masm对 <code>mov al,[0]</code> 等指令的解释</p>
<img src= "/img/loading.gif" data-src="masm的解释.png" alt="masm的解释" style="zoom:70%;" />

<p>Debug的解释：[idata] 是一个内存单元，idata 是内存单元的偏移地址；<br>编译器的解释：[idata] 是 idata。</p>
<p>如何在源程序中实现将内存 2000:0、2000:1、2000:2、2000:3 单元中的数据送入 al，bl，cl，dl中？</p>
<p>比较一下汇编源程序中以下指令的含义：</p>
<img src= "/img/loading.gif" data-src="汇编源程序中以下指令的含义.png" alt="image-20200803114414671" style="zoom:70%;" />

<p><strong>总结：</strong></p>
<ul>
<li>在汇编源程序中，如果用指令访问一个内存单元，则在指令中必须用 <code>[...]</code> 来表示内存单元，如果在 <code>[]</code> 里用一个常量 idata 直接给出内存单元的偏移地址，就要在 <code>[]</code> 的前面显示地给出段地址所在的段寄存器。比如： <code>mov al,ds:[0]</code></li>
<li>如果在 <code>[]</code> 里用寄存器，比如 bx，间接给出内存单元的偏移地址，则段地址默认在 ds 中。当然，也可以显示地给出段地址所在的段寄存器。</li>
</ul>
<h2 id="loop和-bx-的联合应用"><a href="#loop和-bx-的联合应用" class="headerlink" title="loop和[bx]的联合应用"></a>loop和[bx]的联合应用</h2><p>问题：计算 <code>ffff:0~ffff:b</code> 单元中的数据的和，结果存储在 dx 中。</p>
<p>两种方法：1. (dx) = (dx) + 内存中的8位数据 2. (dl) = (dl) + 内存中的8位数据</p>
<p>第一种方法中的问题是两个运算对象的类型不匹配，第二种方法中的问题是结果有可能超界。</p>
<p>所以，我们用一个16位寄存器来做中介，将内存单元中的8位数据赋值到一个16位寄存器ax中，再将ax中的数据加到dx。由于要加12次，我们用loop来实现。</p>
<p>程序5.6</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">	mov ax,0ffffh</span><br><span class="line">	mov ds,ax</span><br><span class="line">	mov bx,0		;初始化 ds:bx 指向ffff:0</span><br><span class="line">	</span><br><span class="line">	mov dx,0		;初始化累加寄存器，(dx)&#x3D;0</span><br><span class="line">	</span><br><span class="line">	mov cx,12		;初始化循环计数寄存器cx，(cx) &#x3D; 12</span><br><span class="line">	</span><br><span class="line">s:  mov al,ds:[bx]</span><br><span class="line">	mov ah,0		;(ax) &#x3D; ((ds) * 16 + (bx))</span><br><span class="line">	add dx,ax		;间接向dx中加上 ((ds) * 16 + (bx))单元的数值</span><br><span class="line">	inc bx			;ds:bx 指向下一个单元</span><br><span class="line">	loop s</span><br><span class="line">	</span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>



<h2 id="段前缀"><a href="#段前缀" class="headerlink" title="段前缀"></a>段前缀</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mov ax,ds:[bx]</span><br><span class="line">mov ax,cs:[bx]</span><br><span class="line">mov ax,ss:[bx]</span><br><span class="line">mov ax,es:[bx]</span><br><span class="line">mov ax,ss:[0]</span><br><span class="line">mov ax,cs:[0]</span><br></pre></td></tr></table></figure>

<p>这些访问内存单元的指令中，显式指明内存单元段地址的 <code>ds:</code> <code>cs:</code> <code>ss:</code> <code>es:</code> ，在汇编语言中称为段前缀。</p>
<h2 id="一段安全的空间"><a href="#一段安全的空间" class="headerlink" title="一段安全的空间"></a>一段安全的空间</h2><p>在8086模式中，随意向一段内存空间写入内容式很危险的，因为这段空间中可能存放着重要的系统数据或代码。</p>
<ul>
<li>我们需要直接向一段内存中写入内容；</li>
<li>这段内存空间不应存放系统或其他程序的数据或代码，否则写入操作系统很可能引发错误；</li>
<li>DOS方式下，一般情况，<code>0:200~0:2ff</code> 空间中没有系统或其他程序的数据或代码；</li>
<li>以后，我们需要直接向一段内存中写入内容时，就使用 <code>0:200~0:2ff</code> 这段空间。</li>
</ul>
<h2 id="段前缀的使用"><a href="#段前缀的使用" class="headerlink" title="段前缀的使用"></a>段前缀的使用</h2><p>问题：将内存 <code>ffff:0~ffff:b</code> 单元中的数据复制到 <code>0:200~0:20b</code> 单元中。</p>
<p>程序5.8</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">	mov ax,0ffffh</span><br><span class="line">	mov ds,ax		;(ds) &#x3D; 0ffffh</span><br><span class="line">	</span><br><span class="line">	mov ax,0020h</span><br><span class="line">	mov es,ax		;(es) &#x3D; 0020h</span><br><span class="line"></span><br><span class="line">	mov bx,0		;(bx) &#x3D; 0，此时 ds:bx 指向 ffff:0，es:bx指向 0020:0</span><br><span class="line">	</span><br><span class="line">	mov cx,12		;(cx) &#x3D; 12，循环12次</span><br><span class="line">	</span><br><span class="line">s:	mov dl,[bx]		;(dl) &#x3D; ((ds) *16 + (bx))，将 ffff:bx 中的数据送入dl</span><br><span class="line">	mov es:[bx],dl	;((es) *16 + (bx))&#x3D; (dl)，将dl中的数据送入 0020:bx</span><br><span class="line">	inc bx			;(bx) &#x3D; (bx) + l </span><br><span class="line">	loop s</span><br><span class="line">	</span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line">code ends</span><br><span class="line">code</span><br></pre></td></tr></table></figure>



<h2 id="实验4-bx-和loop的使用"><a href="#实验4-bx-和loop的使用" class="headerlink" title="实验4 [bx]和loop的使用"></a>实验4 [bx]和loop的使用</h2><p>编程，向内存 <code>0:200~0:23F</code> 依次传送数据 0~63（3FH）,程序中只能使用9条指令，9条指令中包括 <code>mov ax,4c00h</code> 和 <code>int 21h</code> 。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">	mov ax,0020h</span><br><span class="line">	mov ds,ax</span><br><span class="line">	</span><br><span class="line">	mov bx,0</span><br><span class="line">	mov cx,64</span><br><span class="line">	</span><br><span class="line">s:	mov [bx],bx</span><br><span class="line">	inc bx</span><br><span class="line">	loop s</span><br><span class="line">	</span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">LucyConan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://lucyconan.github.io/2020/08/03/%E3%80%8A%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E3%80%8B%E7%8E%8B%E7%88%BD-%E7%AC%AC5%E7%AB%A0%E7%AC%94%E8%AE%B0/">http://lucyconan.github.io/2020/08/03/《汇编语言》王爽-第5章笔记/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%B1%87%E7%BC%96/">汇编</a></div><div class="post_share"><div class="social-share" data-image="/img/huibian.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><button class="reward-button"><i class="fas fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="wechat" onclick="window.open('/img/wechat.jpg')"/><div class="post-qr-code__desc">wechat</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="alipay" onclick="window.open('/img/alipay.jpg')"/><div class="post-qr-code__desc">alipay</div></li></ul></div></button></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2020/08/02/%E3%80%8A%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E3%80%8B%E7%8E%8B%E7%88%BD_%E7%AC%AC4%E7%AB%A0%E7%AC%94%E8%AE%B0/"><img class="next-cover" data-src="/img/huibian.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">《汇编语言》王爽_第4章笔记</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/08/02/《汇编语言》王爽_第4章笔记/" title="《汇编语言》王爽_第4章笔记"><img class="relatedPosts_cover" data-src="/img/huibian.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-02</div><div class="relatedPosts_title">《汇编语言》王爽_第4章笔记</div></div></a></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By LucyConan</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font_plus" title="Increase Font Size"><i class="fas fa-plus"></i></button><button id="font_minus" title="Decrease Font Size"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="Setting"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script></body></html>